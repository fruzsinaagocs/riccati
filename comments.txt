SEE BELOW FOR TODO LIST.
------------------------

Abstract: is clear, but now too long by factor 2 (compare those of
other papers, eg SINUM).  Eg sentence 2 onwards of Abs read like Intro
(have too much detail for Abs), could move there.

Suggest you bullet-list the Abs, making eg 5 key pts.
then write/compress afresh.

Use \emph in Abs even more sparingly, ie no more than once.

You cannot say most things, but just have to hit the key results, eg:

"For the case of the ODE having analytic coefficients, we prove the
asymptotic convergence of the Riccati equationâ€™s residual at a rate
that improves as the rate of change of the frequency gets smaller
relative to its magnitude.  We also provide explicit error bounds
given the number of terms in the asymptotic series."
->
"For analytic coefficients we prove that each iteration, up to a
certain maximum, reduces the residual by a factor of order the local
frequency."

This has most of the content, but half the length.
The rate of change of freq was dropped -- too much detail for Abs.

It takes a lot of editing to make a good Abs!

Last sentence of Abs excellent. 2nd-to-last, try to cut down.

cascade name: not bad - feels like shoehorning to make a word,
ie no letter combos in it remind me
of ode, riccati, iteration, defect correction, phase func, adaptive...
How about RPFDC or ARPFDC
or RFPI

INTRO

para 1 great, just minor tweaks.
It was 22 lines, and too wordy.
I cut it to 16. See what you think - as always, one has to let go of
detail that is not essential to the point of the paper at hand.
(even though you'd like to say it in another paper..)

Para 2-3: see .tex
Point is, you need to be ruthless with cutting details, deciding what is essential for reader to be able to move on, and what not (which is cut or postponed to
discussion later).

p.2: you set gamma=0 in WKB but then leave that 

p.2: You write "Then try... and match..."
But this imperative tense is a bit casual, not used in academic
writing.
Suggest "One then tries... and matches..."
or "Assuming ...  one then matches..."




---------- ongoing Alex comments / changes rationale  11/21/22

* Prop 1: why is non-vanishing of x needed given that x+gamma in denominator?
After prop 1: you needed to update the statement about LB on x_j to be about
x_j+gamma.

* D mat, and spectral meth in general, needed a ref; I gave Tref. old book.

* major notation clash between t_i for time-step intervals vs t_j Cheby nodes.
I changed nodes to tau_j, and killed your "set" notation t_n, which also
clashed.

* first eqn in the matching section was wrong - need t as upper limit.

* Demo section:
The ICs cannot be relevant since the iter doesn't control them, right?
Not sure why ICs are given.

* plots/residual-k-corr.pdf would better label j for iteration not k,
to match paper. We used k as the stopping iter, mostly.
* also for this plot, the y axis is mislabeled. [t_j,t_j+1] is not the
interval used for testing in the text.

* You use "it is worth noting that..." a lot. These filler words don't
  add much. If something needs to be split out for reference
  elsewhere, use Remark env.

* burst eqn has analytic soln, but we don't need this fact, right?


====== REMAINING TO DO LIST ==================================================

* Address the fact that we are now doing better than the condition number of
  the problem would imply.

* @Alex to look through how I addressed his comments/corrections, particularly:
    * the new right-hand panel of Figure 2 and its description in the text,
    * Figure 4's description in the text,
    * the stepsize-update algorithm section (2.6.3),
    * and the new numerical integration text.

* @Fruzsina to run spellcheck on entire document after final Alex revisions.

======== DONE

* You have 3 ways to say om_0 in this work: om_0, om_max (Sec 2.3), and lambda (Sec 4). It would be an improvement to rationalize to a single symbol, eg om_0.
The symbols others used are not sacred, for test problems; more important to have coherency.
-> I think this might be confusing to the reader: om_max is the maximum of \om
on the interval of interest, but e..g \lambda is not; \om_0 isn't necessarily.

* update struct of paper paragraph after later edits
-> Was still correct; didn't change.

* Future work:
 - analyse discretized iteration (matvec plus pointwise square).
  (no reason why high-order derivs on p=16 cheby grid should remain accurate!)
-> Actually this was already mentioned in the conclusions, but added comment.

* cite URL for code repo.

* push the boundaries of understanding the k=5 kink in the demo - is it
do to with n=16? or t=+-i nearby poles, with the long interval [0,2] ??
Consider adding 2nd plot in fig.1 of the R iteration for different interval
or omega(t) func.
-> Done, right-hand-side of Fig 1 now has error model fitting the post-kink
residual curve.

* Consider splitting Fig. 1 R panel to go with much later Airy results.
It's weird to have to go back so far in paper to find this figure.
-> Done, also updated definition of K -- issue is that now we seem to be doing
better than the maximum possible accuracy! :)

* address issues in 4.3: IC, why avoid [0,0.1] and [0.9,1),
speed of new t evals.
-> details of how to get initial conditions, refer to DLMF.
-> UPDATE: now solving on [0.0, 0.9]. No fundamental reason not to start from
0.0, was just a coding issue (w/w'=inf and g/g'= 0 at t=0 caused issues in
stepsize-selection).

* Fig. 4 is never referred to in text! Please fix.

* check Riccati n=40 in Sec 4.2 - seems awfully large.
-> Yep, that's correct. This is a super oscillatory eq well approximated by an
asymptotic expansion at large \lambda, so the solver is taking huge timesteps
(only 2 timesteps during the entire interval). A large n is required for that
many digits of accuracy! I can decrease n, but we will lose digits.

* Table 2 uses Ricc, Cheb but Table 1 and text
uses osc, slo. Please be consistent.

* Table 1 {bremer237tab} needs method labels.
  Add Bremer timings on your machine, maybe add # func evals in the Table.
  OR, just quotes some timings in the text, to get the timing ratio on the
  same machine. Decide how much of a deal you're making about the 10x speedup,
  if it persists on the same machine.
 
* consider using block 2x2 notation for {discreteodeic} to save vertical space

* figure 2 balls: could you move the rho label to look like the radius -
currently it's confusing since the label on the Im axis should be -rho.

* fig 2 flowchart: t_i is used in text, so change t_j to t_i to match.

* remove 1/2pi factor from kappa estimate in code.
(since radians phase is better estimate than # periods.) Text is done.

* correct that we solve for derivative of phase function.
Not PF itself.  Correct alpha usage in Bremer review.

* explain diff btw us and Bremer:
Bremer converts globally to phase func, then solves adaptively on panels over global region, vs we discretize adaptively on panels before converting to phase func.  We patch together solutions at panel level.
Thus no windowing needed.

* add timings and CPU/Py specs to Sec 4, 4.1.

* fixed om to om^2 in diag term in {discreteode}

* Abs claims n is adapted in the Cheby scheme, but it's not, right? Just h?
Please check.

-> n is actually adapted between nmin and nmax, with these being chosen by the
used but having default values of nmin = 16 and nmax = 64. In each iteration,
the number of nodes is doubled. Can we change this back to how it was?


* apostrophes are too casual ( "method's" etc)

* I am not using the sec 6 list of changes - suggest cut so the
paper looks as it should.

* oscode & related: local vs global h-order (and power of om_0 ?)
needed clarified

* QLM is Newton iter not series, clarified.

* note don't mix \dot{x} and x'

* suggest Bremer's method is not called "the phase function method".

-> Just to explain the choice: this is what Bremer's code repo is called (Phase-functions).

* I corrected prefactor of al''/al in {kummer} to 1/2.

* Check "smoothness" of Fourier xform of log Omega.

* Is our method an "expansion", an "iteration", a "series", a "defect correction" ? It is best to stick to one. I think "iteration" and "defect correction" are clearest.  Hence edits.

* the "structure of this paper" para: note I highlighted *rigorous* analysis.

* I disagree with the Im [log (u(t1)/|u(t1)|) - log (u(t0)/|u(t0)|)]
definition since the dividing by the magnitude *inside* the log
messes up the phase. You'd want
Im [ log u(t1) - log u(t0) ], right?

* Also: tricky thing about kappa defn is that relies on continuity of log
(correct branch cut, needed for Im to count the windings), but this
isn't entirely apparent from (48).

* burst demo: your choice of test interval [0,2] is very wide, with omega dropping by factor 5 over the interval, and having a nearby singularity at +-i.
Yet it still works. But we have to comment about this.

* burst eqn you state as m^2-1 upstairs but then state om_max = sqrt(m^2+1) ...
which is it? (inconsistent)

* remove nmax = 64 everywhere, simplify explanation of 16,32 h-adapt rule.

====== OLD TO DO LIST FROM MAIN.TEX  ==================================================

% Some things left to do:  (are this FA or AB ones? Are some obsolete?) These are for FA! Some may be obsolete.
% AB comments with "-"

% Figure for complex plane setup for proof of thm 3
% - sure, get from your talk.

% Numerically stable residual iterations!
% - not sure what you mean

% Final description of stepsize algorithm 
% Flowchart?
%  - imprt from talk

% Cosmo stuff? (Paper is too long!)
% - see once finer edit.

% Bremer's basic iteration (worked it out on paper but paper is already too long)
% - add footnote saying other iterations exist, give Bremer's. Note it
% needs sqrt which bring branch issue.

% Some comment that although theorem is pointwise convergence, uniform convergence over some interval is trivial by enclosing it in a larger ball.}
%  - ok, put in Sec 3.

% Relate the ball in the theorem to the interval size that can be well-approximated by $p$th order Cheby, using Bernstein ellipse of Tref
% - too much for here.

% From [residual of ODE and Riccati] to solution error bounds, maybe? This is similar to local discretization err in a more typical numerical solver. (check LeVeque, Tref, Hairer, etc).
% - too hard, state in Discussion.

% Numerical results to support deterioration of convergence rate r with total iteration number k in Thm (figure?)
% - no you have this in Fig 1 right?

% More references needed
% - just in intro


